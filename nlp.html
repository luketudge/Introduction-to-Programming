
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Natural language processing &#8212; Introduction to Programming with Python</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The internet" href="internet.html" />
    <link rel="prev" title="Data analysis" href="data_analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Programming with Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  get started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="setup.html">
   Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="readings.html">
   Readings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Creating a computer program with Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  the basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="types.html">
   Variables and data types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sequences_mappings.html">
   Sequences and mappings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conditions.html">
   Conditions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modules.html">
   Modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="standard_library.html">
   The standard library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html">
   Files
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  software development
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="command_line.html">
   The command line
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="github.html">
   GitHub
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  specialist topics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   Array computing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="images.html">
   Images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_analysis.html">
   Data analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Natural language processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="internet.html">
   The internet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="databases.html">
   Relational databases
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/nlp.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/luketudge/introduction-to-programming"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/luketudge/introduction-to-programming/issues/new?title=Issue%20on%20page%20%2Fnlp.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/luketudge/introduction-to-programming/master?urlpath=tree/content/nlp.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/luketudge/introduction-to-programming/blob/master/content/nlp.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#objective">
   Objective
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#string-methods-again">
   String methods again
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regular-expressions">
   Regular expressions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nltk">
   nltk
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tokenization">
     Tokenization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pos-tagging">
     POS tagging
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sentences">
     Sentences
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spacy">
   spacy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="natural-language-processing">
<h1>Natural language processing<a class="headerlink" href="#natural-language-processing" title="Permalink to this headline">¶</a></h1>
<p>We have learned how to work with data organized as an <a class="reference internal" href="arrays.html"><span class="doc std std-doc">array</span></a> of numbers, using the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> package, or more generally as a <a class="reference internal" href="data_analysis.html"><span class="doc std std-doc">table</span></a> of numeric and text columns, using <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. We have also learned a bit about <a class="reference internal" href="images.html"><span class="doc std std-doc">working with image files</span></a>. The other major data format that you are likely to encounter in many computer programming tasks is natural, human-language text.</p>
<p>In computing, people often refer to the languages that human beings use for everyday communication, such as English or Pirahá, as ‘natural’ languages. This distinguishes them from programming languages like Python, and helps avoid confusion, for example when asking a computer person ‘What language do you use at work?’ Using computers to analyze natural language is often called ‘Natural Language Processing’ (NLP).</p>
<p>Computers still have huge difficulty responding to natural language appropriately. Here we will introduce a few tools and techniques that can help if we need to write a computer program that takes natural language text as its input. These techniques are useful in many common programming tasks:</p>
<ul class="simple">
<li><p>translating between natural languages</p></li>
<li><p>classifying texts by topic</p></li>
<li><p>identifying particular tones or styles, for example rude or offensive posts in a forum</p></li>
<li><p>creating chatbots or generating automated responses to customer queries</p></li>
<li><p>… and even some genuinely useful things like <a class="reference external" href="https://dl.acm.org/doi/10.5555/1314498.1314541">establishing the authorship of anonymous works of literature</a></p></li>
</ul>
<p>Real-world natural language processing tasks like these are usually quite complex, and require a ‘pipeline’ of multiple techniques. As usual, we will only cover the basics. After our short introduction, you should know at least where to start if you later come to work with natural language text data.</p>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this headline">¶</a></h2>
<p>Here is our toy task for this lesson.</p>
<p>Let’s imagine we have landed a job as an editor at a pretentious elitist newspaper, and we would like to write a program that helps us identify all the sentences in a text that violate one of the woefully misguided rules of the newspaper’s style handbook. Let’s take three example rules:</p>
<ul class="simple">
<li><p>A preposition (such as for, to, etc.) is not a good thing to end a sentence with.</p></li>
<li><p>To boldly place an intervening word between the <code class="docutils literal notranslate"><span class="pre">to</span></code> and the <code class="docutils literal notranslate"><span class="pre">verb</span></code> in an infinitive is forbidden.</p></li>
<li><p>And you shouldn’t begin a sentence with a conjunction (such as and, but, etc.)</p></li>
</ul>
<p>This isn’t a completely unrealistic example. Talking right is something that many people still get <a class="reference external" href="https://www.theguardian.com/books/booksblog/2015/oct/06/steven-pinker-alleged-rules-of-writing-superstitions">very excited</a> about.</p>
<p>So that we have a large example text to work with, let’s load the classic go-to text for all NLP examples ever, <em>Moby Dick</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">md</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;melville-moby_dick.txt&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">md</span><span class="p">[:</span><span class="mi">433</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Moby Dick by Herman Melville 1851]


ETYMOLOGY.

(Supplied by a Late Consumptive Usher to a Grammar School)

The pale Usher--threadbare in coat, heart, body, and brain; I see him
now.  He was ever dusting his old lexicons and grammars, with a queer
handkerchief, mockingly embellished with all the gay flags of all the
known nations of the world.  He loved to dust his old grammars; it
somehow mildly reminded him of his mortality.
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="string-methods-again">
<h2>String methods again<a class="headerlink" href="#string-methods-again" title="Permalink to this headline">¶</a></h2>
<p>Let’s dive right in and just take a naive stab at the first rule, about not having a preposition at the end of a sentence. Ignoring for a moment any initial processing, such as splitting up the full text into sentences, we can first write a <a class="reference internal" href="glossary.html#function"><span class="std std-doc">function</span></a> to determine whether or not a single sentence violates the rule.</p>
<p>Remember the <a class="reference internal" href="functions.html#defining-functions"><span class="std std-ref">main ingredients of a function</span></a>:</p>
<ul class="simple">
<li><p><strong>The name of the function</strong>. This function’s job is just to say ‘yes’ or ‘no’. For such functions, a good choice of name is some abbreviated form of a ‘yes/no’ question. We can go with <code class="docutils literal notranslate"><span class="pre">endswith_preposition</span></code>.</p></li>
<li><p><strong>Its input <a class="reference internal" href="glossary.html#argument"><span class="std std-doc">arguments</span></a></strong>. This is easy. The single input argument is a <a class="reference internal" href="glossary.html"><span class="doc std std-doc">string</span></a> containing the sentence.</p></li>
<li><p><strong>What steps it carries out (the ‘body’ of the function)</strong>. There is room for some variation and choice of strategy here. But a simple start would be to split the sentence into words, get the final one, remove any punctuation characters, then compare it to a list of prepositions.</p></li>
<li><p><strong>The <a class="reference internal" href="glossary.html#return"><span class="std std-doc">return value</span></a></strong>. We don’t actually want to return the printed answer <code class="docutils literal notranslate"><span class="pre">'yes'</span></code> or <code class="docutils literal notranslate"><span class="pre">'no'</span></code>. If our function is to be useful as part of a bigger program, it needs to return the computer versions of ‘yes’ and ‘no’, a <a class="reference internal" href="glossary.html#boolean"><span class="std std-doc">boolean</span></a>, with <code class="docutils literal notranslate"><span class="pre">True</span></code> for ‘yes the sentence violates the rule’ and <code class="docutils literal notranslate"><span class="pre">False</span></code> for ‘no it does not’.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">punctuation</span> <span class="o">=</span> <span class="s1">&#39; .,?!:;&#39;</span>
<span class="n">prepositions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;around&#39;</span><span class="p">,</span> <span class="s1">&#39;about&#39;</span><span class="p">,</span> <span class="s1">&#39;at&#39;</span><span class="p">,</span> <span class="s1">&#39;by&#39;</span><span class="p">,</span> <span class="s1">&#39;down&#39;</span><span class="p">,</span> <span class="s1">&#39;from&#39;</span><span class="p">,</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="s1">&#39;with&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">endswith_preposition</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">final_word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="n">punctuation</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">prepositions</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s give our function a quick test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endswith_preposition</span><span class="p">(</span><span class="s1">&#39;This is the sort of mindless pedantry I just cannot put up with!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endswith_preposition</span><span class="p">(</span><span class="s1">&#39;This is the sort of mindless pedantry up with which I just cannot put!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>It works. But you can probably already spot a few deficiencies. For example, there are other punctuation characters that might end a sentence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endswith_preposition</span><span class="p">(</span><span class="s1">&#39;I said &quot;This is the sort of mindless pedantry I just cannot put up with!&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regular-expressions">
<h2>Regular expressions<a class="headerlink" href="#regular-expressions" title="Permalink to this headline">¶</a></h2>
<p>Some of the difficulties of working with natural language text can be handled using a particular programming language whose sole purpose is to specify patterns of text characters to search for. Pieces of code written in this language are known as <a class="reference internal" href="glossary.html#regex"><span class="std std-doc">regular expressions</span></a>, sometimes abbreviated to ‘regex’.</p>
<p>There is a third-party Python <a class="reference internal" href="glossary.html#package"><span class="std std-doc">package</span></a> for working with regular expressions. Let’s import it so that we can see a few examples of regular expressions in action.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">regex</span>
</pre></div>
</div>
</div>
</div>
<p>(Note that there is also a package in Python’s <a class="reference internal" href="standard_library.html"><span class="doc std std-doc">standard library</span></a> called <code class="docutils literal notranslate"><span class="pre">re</span></code>, which provides the same functions as <code class="docutils literal notranslate"><span class="pre">regex</span></code>. But <code class="docutils literal notranslate"><span class="pre">re</span></code> has several limitations, so I recommend working with <code class="docutils literal notranslate"><span class="pre">regex</span></code> instead.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">regex</span></code> package provides various functions, but the one that we will use here is <code class="docutils literal notranslate"><span class="pre">findall()</span></code>, which takes two <a class="reference internal" href="glossary.html#argument"><span class="std std-doc">arguments</span></a>, a regular expression giving a pattern of text, and a <a class="reference internal" href="glossary.html#string"><span class="std std-doc">string</span></a> in which to search for that pattern. The function <a class="reference internal" href="glossary.html#return"><span class="std std-doc">returns</span></a> a list of all the matches.</p>
<p>Regular expressions are a programming language all of their own. We won’t cover here all of the rules of regular expressions. But the basic idea is that a regular expression contains normal text plus certain special characters that have particular meanings. Normal text characters simply specify that exact piece of text. So for example the regular expression <code class="docutils literal notranslate"><span class="pre">cat</span></code> will match all the occurrences of that exact sequence of characters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;That big fat cat on the flat mat is my cat Pat.&#39;</span>

<span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;cat&#39;, &#39;cat&#39;]
</pre></div>
</div>
</div>
</div>
<p>There are lots of special characters or combinations of characters that can be used in regular expressions to specify more abstract matches. For example, what if we want any word that ends in ‘at’? A range of alphabetic characters enclosed in square parentheses <code class="docutils literal notranslate"><span class="pre">[]</span></code> means ‘any one of these characters’. So a first stab at finding all the words ending in ‘at’ might be:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[a-z]at&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;hat&#39;, &#39;fat&#39;, &#39;cat&#39;, &#39;lat&#39;, &#39;mat&#39;, &#39;cat&#39;]
</pre></div>
</div>
</div>
</div>
<p>This gets us all the cases of exactly one letter followed by ‘at’, but this results in some ‘chopped off’ words. The special character <code class="docutils literal notranslate"><span class="pre">+</span></code> means ‘one or more occurrences of the preceding pattern’, so we can add this in to also make sure we get the full words with more than one letter before the ‘at’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[a-z]+at&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;hat&#39;, &#39;fat&#39;, &#39;cat&#39;, &#39;flat&#39;, &#39;mat&#39;, &#39;cat&#39;]
</pre></div>
</div>
</div>
</div>
<p>Regular expressions draw a distinction between upper and lower case letters. So to get the words with initial uppercase letters as well, we need to add the range of uppercase letters to our <code class="docutils literal notranslate"><span class="pre">[]</span></code> sequence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;[a-zA-Z]+at&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;That&#39;, &#39;fat&#39;, &#39;cat&#39;, &#39;flat&#39;, &#39;mat&#39;, &#39;cat&#39;, &#39;Pat&#39;]
</pre></div>
</div>
</div>
</div>
<p>Regular expressions may also contain certain character sequences that represent a whole ‘class’ of characters. These special sequences always begin with the backslash <code class="docutils literal notranslate"><span class="pre">\</span></code>. For example, the special sequence <code class="docutils literal notranslate"><span class="pre">\w</span></code> matches ‘word’ characters, which covers all letters plus the underscore <code class="docutils literal notranslate"><span class="pre">_</span></code>. This is commonly useful for breaking a text into words while leaving out punctuation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\w+&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;That&#39;,
 &#39;big&#39;,
 &#39;fat&#39;,
 &#39;cat&#39;,
 &#39;on&#39;,
 &#39;the&#39;,
 &#39;flat&#39;,
 &#39;mat&#39;,
 &#39;is&#39;,
 &#39;my&#39;,
 &#39;cat&#39;,
 &#39;Pat&#39;]
</pre></div>
</div>
</div>
</div>
<p>There is lots lots more that can be done with regular expressions. You can read about the full set of special regex characters on the <a class="reference external" href="https://docs.python.org/3/library/re.html">Python documentation page for regular expressions</a>.</p>
<p>There is also an interactive regex testing site, where you can enter a regular expression plus some example text and check whether your regeular expression has any matches in the text. <a class="reference external" href="https://regex101.com/">Try it out</a>.</p>
<p>For now, let’s apply the little that we have learned about regular expressions to improve our <code class="docutils literal notranslate"><span class="pre">endswith_preposition()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">endswith_preposition</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;\w+&#39;</span><span class="p">,</span> <span class="n">sentence</span><span class="p">)</span>
    <span class="n">final_word</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">final_word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">prepositions</span>

<span class="n">endswith_preposition</span><span class="p">(</span><span class="s1">&#39;I said &quot;This is the sort of mindless pedantry I just cannot put up with!&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="nltk">
<h2>nltk<a class="headerlink" href="#nltk" title="Permalink to this headline">¶</a></h2>
<p>But we still have a problem with our list of prepositions. It is far from complete.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">endswith_preposition</span><span class="p">(</span><span class="s2">&quot;Now that&#39;s the kind of pedantry I can get behind!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<p>Regular expressions aren’t going to be of much help fixing this second limitation of our function. We could of course just include more prepositions in our list. But there are <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_English_prepositions">a lot of prepositions</a> that we would need to take into account.</p>
<p>As we have seen a few times before, when we encounter what seems like a difficult but common problem, there may be some tools already out there that can help save us from re-inventing the wheel. There are lots of Python <a class="reference internal" href="glossary.html#package"><span class="std std-doc">packages</span></a> for NLP, which apply various techniques ranging from simple string processing like in our example function above, to something more like artificial intelligence.</p>
<p>We will look at just one NLP package, called <code class="docutils literal notranslate"><span class="pre">nltk</span></code>, which stands for ‘natural language tool kit’. The tools provided by <code class="docutils literal notranslate"><span class="pre">nltk</span></code> are a bit more complex than our example function, but still simple enough to be suitable for an introduction to NLP. Indeed, <code class="docutils literal notranslate"><span class="pre">nltk</span></code> was originally created to teach linguists how to do computing with Python, and it accompanies a book about Python and NLP, which is <a class="reference external" href="http://www.nltk.org/book">free to read online</a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">nltk</span></code> is included in the default Anaconda installation, so if you have Anaconda then you will have it already. Let’s import it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
</pre></div>
</div>
</div>
</div>
<p>Dealing with natural language often requires quite a lot of extra data. For example, we might need pre-compiled lists of word types, a database of grammatical rules, and so on. <code class="docutils literal notranslate"><span class="pre">nltk</span></code> includes various extra data files of this kind, but it does not install them all by default, in order to save space for users who do not need all of it. So the first time you use <code class="docutils literal notranslate"><span class="pre">nltk</span></code> you may find that you need to download extra components. For simplicity, I will simply download them all here so that we definitely have everything that we need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>There are a lot of extra data files in the full package. If you prefer to pick and choose which extra components of <code class="docutils literal notranslate"><span class="pre">nltk</span></code> to download, call the downloader function with no arguments, and a window will pop up allowing you to browse components:</p>
<p><code class="docutils literal notranslate"><span class="pre">nltk.download()</span></code></p>
<p>Now we are ready to make use of <code class="docutils literal notranslate"><span class="pre">nltk</span></code>’s pre-compiled knowledge of word types in order to label words as prepositions.</p>
<div class="section" id="tokenization">
<h3>Tokenization<a class="headerlink" href="#tokenization" title="Permalink to this headline">¶</a></h3>
<p>The first step is to split our text into words. We already managed this above using the basic Python string <a class="reference internal" href="glossary.html#method"><span class="std std-doc">method</span></a> <code class="docutils literal notranslate"><span class="pre">split()</span></code>. But to see how this can be achieved with <code class="docutils literal notranslate"><span class="pre">nltk</span></code>, let’s use <code class="docutils literal notranslate"><span class="pre">nltk</span></code>’s own function for this, <code class="docutils literal notranslate"><span class="pre">word_tokenize()</span></code>.</p>
<p>In NLP, the term ‘token’ refers to an instance of some meaningful unit of language. Most tokens are words, but not all. Sometimes, we might wish to consider punctuation as meaningful, in which case a punctuation character is a token. And sometimes we might consider a word to be meaningful only as part of group of words but not on its own, in which case that group of words is a token (one example of this latter case is names of people or places, such as ‘Los Angeles’, in everyday English ‘Los’ is not really a token).</p>
<p>The process of splitting a text into tokens is called ‘tokenization’. We can see some of the differences between this process and simple splitting by comparing the two.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;I&#39;m ready!Let&#39;s go&quot;</span>

<span class="n">sentence</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;I&#39;m&quot;, &quot;ready!Let&#39;s&quot;, &#39;go&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;I&#39;, &quot;&#39;m&quot;, &#39;ready&#39;, &#39;!&#39;, &#39;Let&#39;, &quot;&#39;s&quot;, &#39;go&#39;]
</pre></div>
</div>
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">word_tokenize()</span></code> handles contractions like <em>I’m</em> as two tokens, and also deals correctly with typing errors such as missing spaces after punctuation.</p>
<p>Now let’s tokenize one of our example sentences from above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sentence</span> <span class="o">=</span> <span class="s2">&quot;Now that&#39;s the kind of pedantry I can get behind!&quot;</span>

<span class="n">tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>

<span class="n">tokens</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Now&#39;,
 &#39;that&#39;,
 &quot;&#39;s&quot;,
 &#39;the&#39;,
 &#39;kind&#39;,
 &#39;of&#39;,
 &#39;pedantry&#39;,
 &#39;I&#39;,
 &#39;can&#39;,
 &#39;get&#39;,
 &#39;behind&#39;,
 &#39;!&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pos-tagging">
<h3>POS tagging<a class="headerlink" href="#pos-tagging" title="Permalink to this headline">¶</a></h3>
<p>Once we have our tokens, the next step is to ‘tag’ the tokens as belonging to linguistic categories like ‘noun’, ‘verb’, ‘preposition’, etc. These categories are often called ‘parts of speech’ (abbreviated to POS). The <code class="docutils literal notranslate"><span class="pre">nltk</span></code> function for assigning parts of speech to tokens is <code class="docutils literal notranslate"><span class="pre">pos_tag()</span></code>.</p>
<p>There are many different conventions concerning how to name and abbreviate the different possible parts of speech. These different conventions are known as ‘tagsets’. An additional <a class="reference internal" href="glossary.html#argument"><span class="std std-doc">argument</span></a> can be used to specify the tagset to use. We will use a simplified ‘universal’ tagset here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tagset</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">)</span>

<span class="n">pos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Now&#39;, &#39;ADV&#39;),
 (&#39;that&#39;, &#39;DET&#39;),
 (&quot;&#39;s&quot;, &#39;VERB&#39;),
 (&#39;the&#39;, &#39;DET&#39;),
 (&#39;kind&#39;, &#39;NOUN&#39;),
 (&#39;of&#39;, &#39;ADP&#39;),
 (&#39;pedantry&#39;, &#39;NOUN&#39;),
 (&#39;I&#39;, &#39;PRON&#39;),
 (&#39;can&#39;, &#39;VERB&#39;),
 (&#39;get&#39;, &#39;VERB&#39;),
 (&#39;behind&#39;, &#39;ADP&#39;),
 (&#39;!&#39;, &#39;.&#39;)]
</pre></div>
</div>
</div>
</div>
<p>We get a list of <a class="reference internal" href="glossary.html#tuple"><span class="std std-doc">tuples</span></a>, in each of which the token is the first entry and its POS tag is the second entry.</p>
<p>If you are wondering what the tags mean, you can see a table of them on the <a class="reference external" href="http://www.nltk.org/book/ch05.html#tab-universal-tagset">nltk website</a>. Here are the ones that we are interested in for our task:</p>
<ul class="simple">
<li><p><strong>ADP</strong> : adposition (which to a linguistics blockhead like me is basically the same thing as a preposition)</p></li>
<li><p><strong>.</strong> : punctuation</p></li>
</ul>
<p>We need to remove any punctuation tokens, in order to make sure that the last item in our list is the last actual word and not any final punctuation mark. Then we need to check whether the final item has been tagged ‘ADP’.</p>
<p>So here is our updated function, which includes a little extra trick to reverse the list of tokens and then go through them to find the first non-punctuation token.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">endswith_preposition</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">tagset</span><span class="o">=</span><span class="s1">&#39;universal&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ADP&#39;</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="n">endswith_preposition</span><span class="p">(</span><span class="s2">&quot;Now that&#39;s the kind of pedantry I can get behind!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Success!</p>
</div>
<div class="section" id="sentences">
<h3>Sentences<a class="headerlink" href="#sentences" title="Permalink to this headline">¶</a></h3>
<p>Now we are ready to apply our function to the text of <em>Moby Dick</em>. There is an <code class="docutils literal notranslate"><span class="pre">nltk</span></code> function for splitting a text into sentences. We need to apply this function, then go through the sentences and check them with our own <code class="docutils literal notranslate"><span class="pre">endswith_preposition()</span></code> function. To keep the output brief, we will only print the first few matches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">nltk</span><span class="o">.</span><span class="n">sent_tokenize</span><span class="p">(</span><span class="n">md</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">endswith_preposition</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">sentence</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;No, Sir, &#39;tis a Right Whale,&quot; answered Tom; &quot;I saw his sprout; he
threw up a pair of as pretty rainbows as a Christian would wish to
look at. 

so near! 

They must get just as nigh
the water as they possibly can without falling in. 

Tell me that. 

Again, I always go to sea as a sailor, because they make a point of
paying me for my trouble, whereas they never pay passengers a single
penny that I ever heard of. 
</pre></div>
</div>
</div>
</div>
<p>Our solution to the task works, more or less. But we can see here already some of the difficulties of using computers to process natural language. For example, the ‘that’ in ‘Tell me that’ is not really being used as a preposition.</p>
<p>To see some more NLP in action, take a look at the example program <span class="xref myst">pedantry.py</span>, which implements functions for checking the three prescriptive grammar rules from our example task, as well as an overall function for searching a text for any violations of the rules.</p>
</div>
</div>
<div class="section" id="spacy">
<h2>spacy<a class="headerlink" href="#spacy" title="Permalink to this headline">¶</a></h2>
<p>As we have seen, even a fairly simple NLP task like finding sentences that match a certain grammatical pattern can be very tricky. In natural language, context matters a great deal. A word may have different meanings or grammatical roles depending on the surrounding words. Simple techniques like regular expressions, and the basic NLP tools provided by <code class="docutils literal notranslate"><span class="pre">nltk</span></code>, will usually not be enough for real-world NLP problems. For many such problems, the current cutting-edge solutions rely on various machine learning techniques, which involve first ‘training’ a fairly complex program at the task. This is the topic of the next lesson.</p>
<p>One of the most popular Python packages for applying machine learning specifically to NLP is called <code class="docutils literal notranslate"><span class="pre">spacy</span></code>. The <code class="docutils literal notranslate"><span class="pre">spacy</span></code> package provides pre-trained computer ‘models’ of language, which can then be applied to piece apart the structure of a natural language text. This package is too big and too complex for our introduction here, but if you would like to learn more you can see examples and tutorials on the <a class="reference external" href="https://spacy.io/">spacy website</a>.</p>
</div>
<div class="section" id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<p>English often contains some compound adjectives or adverbs in which two or more words are joined by a hyphen, and the final word is a verb in the past tense. For example:</p>
<ul class="simple">
<li><p>old-fashioned</p></li>
<li><p>absent-minded</p></li>
<li><p>grey-headed</p></li>
<li><p>open-mouthed</p></li>
<li><p>so-called</p></li>
<li><p>good-natured</p></li>
<li><p>one-armed</p></li>
</ul>
<p>Write a program that finds occurrences of these compound phrases in a text. Apply it to the text of <em>Moby Dick</em> and print out any compound phrases that occur three or more times in the text. You should find that it prints the seven example phrases above.</p>
<p>The documentation for <code class="docutils literal notranslate"><span class="pre">nltk</span></code> is not always so easy to navigate, so here is a hint:</p>
<p>Earlier on, we used the ‘universal’ tagset for tagging words with parts of speech. This tagset is useful for simple distinctions betweens verbs, nouns, adjectives, and so on. The default tagset for <code class="docutils literal notranslate"><span class="pre">pos_tag()</span></code> provides more detailed tags that distinguish between verbs in the past and present tense. If you use <code class="docutils literal notranslate"><span class="pre">pos_tag()</span></code> without the <code class="docutils literal notranslate"><span class="pre">tagset</span></code> argument, you will get these more detailed tags.</p>
<p>For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phrase</span> <span class="o">=</span> <span class="s1">&#39;The cat sat on the mat. The cat sits on the mat.&#39;</span>
<span class="n">tokens</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">phrase</span><span class="p">)</span>

<span class="n">nltk</span><span class="o">.</span><span class="n">pos_tag</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;The&#39;, &#39;DT&#39;),
 (&#39;cat&#39;, &#39;NN&#39;),
 (&#39;sat&#39;, &#39;VBD&#39;),
 (&#39;on&#39;, &#39;IN&#39;),
 (&#39;the&#39;, &#39;DT&#39;),
 (&#39;mat&#39;, &#39;NN&#39;),
 (&#39;.&#39;, &#39;.&#39;),
 (&#39;The&#39;, &#39;DT&#39;),
 (&#39;cat&#39;, &#39;NN&#39;),
 (&#39;sits&#39;, &#39;VBZ&#39;),
 (&#39;on&#39;, &#39;IN&#39;),
 (&#39;the&#39;, &#39;DT&#39;),
 (&#39;mat&#39;, &#39;NN&#39;),
 (&#39;.&#39;, &#39;.&#39;)]
</pre></div>
</div>
</div>
</div>
<p>The ‘VBD’ tag represents a verb in the past tense, as you can see for the word ‘sat’ here, so this is the tag you will need to look for to identify hyphenated phrases that end in a past-tense verb.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="data_analysis.html" title="previous page">Data analysis</a>
    <a class='right-next' id="next-link" href="internet.html" title="next page">The internet</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>